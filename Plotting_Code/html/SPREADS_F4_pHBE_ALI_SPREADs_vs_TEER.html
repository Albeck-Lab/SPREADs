<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>Figure 4 - pHBE in differentiated in ALI</title>
<meta name="generator" content="MATLAB 24.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2024-08-02">
<meta name="DC.source" content="SPREADS_F4_pHBE_ALI_SPREADs_vs_TEER.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h1>Figure 4 - pHBE in differentiated in ALI</h1>
<!--introduction-->
<!--/introduction-->
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">Figure 4A - pHBE in ALI response to 20ng/mL IL1b</a>
</li>
<li>
<a href="#2">Figure 4B - pHBE ALI SPREADs occuring after 20ng/mL IL1b treatment</a>
</li>
<li>
<a href="#3">Figure 4 C-E SPREAD vs TEER Correlation plot</a>
</li>
<li>
<a href="#4">Also check other runs</a>
</li>
<li>
<a href="#5">Now plot Figure 4C-E to be appended to the image montages</a>
</li>
</ul>
</div>
<h2 id="1">Figure 4A - pHBE in ALI response to 20ng/mL IL1b</h2>
<p>Images and sup video 7 are from 2022-11-03 pHBE ALI experiment plate 2 (data is used below as well)</p>
<pre class="codeinput">
<span class="comment">% scale bar is 250uM</span>
<span class="comment">% from: 2022-11-03 pHBE ALI pt5 virus EKAREN4 Cytokines</span>
<span class="comment">% xy 25 (20ng/mL il1b treated at ~1.1hr from start) 6 min loop time</span>
<span class="comment">% Movie tps from start kept (in min):</span>
<span class="comment">% 42, 54, 66, 78, 90, 102</span>
</pre>
<h2 id="2">Figure 4B - pHBE ALI SPREADs occuring after 20ng/mL IL1b treatment</h2>
<p>Images and sup video 7 are from 2022-11-03 pHBE ALI experiment plate 2 (data is used below as well)</p>
<pre class="codeinput">
<span class="comment">% scale bar is 250uM</span>
<span class="comment">% from: 2022-11-03 pHBE ALI pt5 virus EKAREN4 Cytokines</span>
<span class="comment">% xy 25 (20ng/mL il1b treated at ~1.1hr from start) 6 min loop time</span>
<span class="comment">% Movie tps from start kept (in min):</span>
<span class="comment">% 456, 468, 480, 948, 966, 984</span>
</pre>
<h2 id="3">Figure 4 C-E SPREAD vs TEER Correlation plot</h2>
<pre class="codeinput">
<span class="comment">% add paths</span>
addpath(<span class="string">'Z:\Code\Image Analysis\'</span>,<span class="string">'Z:\Code\Cell Trace\'</span>,<span class="string">'Z:\Code\Nick\'</span>)

<span class="comment">% Make the plot for the experiment with live cell and TEER data</span>
<span class="comment">% Run 1's data 2022-11-03 data</span>

<span class="comment">% Load the live cell data</span>
dataloc = load(<span class="string">'Z:\Processed Data\SPREADs\2022-11-03 pHBE EKAREN4 ALI Cytokine P2\2022-11-03 pHBE EKAREN4 ALI Cytokine P2_Processed_Copy.mat'</span>);
dataloc = dataloc.dataloc;

<span class="comment">% Extract the SPREADs data</span>
spreadData = convertSPREADToDataframe2(dataloc, <span class="string">'EKAR'</span>, <span class="string">'tmaxaftertx'</span>,30);

<span class="comment">% shorten the tx names for simplicity</span>
spreadData.txinfo = strrep(spreadData.txinfo,<span class="string">'20ng/mL '</span>,<span class="string">''</span>);
spreadData.txinfo = strrep(spreadData.txinfo,<span class="string">'10ng/mL '</span>,<span class="string">''</span>);
spreadData.txinfo = strrep(spreadData.txinfo,<span class="string">'1 '</span>,<span class="string">''</span>);

<span class="comment">% get the statistics</span>
spreadStats = grpstats(spreadData,<span class="string">"txinfo"</span>,[<span class="string">"mean"</span>,<span class="string">"median"</span>,<span class="string">"sem"</span>],<span class="string">"DataVars"</span>,<span class="string">"freq"</span>);

<span class="comment">% subtract each run's own mean from its own run</span>
spreadData.freqSubV = spreadData.freq - spreadStats{<span class="string">"vehicle"</span>,<span class="string">"mean_freq"</span>};

<span class="comment">% Add the TEER data (Mean data from the same experimental dataset, 2022-11-03</span>
<span class="comment">% for both the imaged plate and the second plate that had the technical replicates)</span>
<span class="comment">% This data can be found in the Notes section of the _platemap data for the experiment</span>
<span class="comment">% Which can be found here: SPREADs\Plotting_Code\TEER_Data_For_plots.xlsx</span>
teerData = table();
teerData.PercChangeInTeer = [0; -9.92; -19.59; -3.761];
teerData.TeerSEM = [3.5846; 2.8435; 1.8805; 1.5199];
teerData.Properties.RowNames = {<span class="string">'vehicle'</span>,<span class="string">'IL6'</span>, <span class="string">'IL1b'</span>,<span class="string">'EGF'</span>};

<span class="comment">% Merge the tables to make plotting easier</span>
spreadTEERdata = join(spreadStats,teerData,<span class="string">'Keys'</span>,<span class="string">'Row'</span>);

<span class="comment">% subtract the vehicle spread freq for combining replicates</span>
spreadTEERdata.freq_minus_cont = spreadTEERdata{:,<span class="string">"mean_freq"</span>} - spreadTEERdata{<span class="string">"vehicle"</span>,<span class="string">"mean_freq"</span>}
</pre>
<pre class="codeoutput">spreadTEERdata =
  4&times;8 table
                txinfo      GroupCount    mean_freq    median_freq    sem_freq    PercChangeInTeer    TeerSEM    freq_minus_cont
               _________    __________    _________    ___________    ________    ________________    _______    _______________
    vehicle    "vehicle"        9          0.10487      0.086677      0.013662              0         3.5846                0   
    IL6        "IL6"            9          0.28678       0.20225      0.059277          -9.92         2.8435          0.18191   
    IL1b       "IL1b"           9          0.33387       0.17335       0.17861         -19.59         1.8805            0.229   
    EGF        "EGF"            9          0.11022       0.10594      0.017954         -3.761         1.5199        0.0053504   
</pre>
<h2 id="4">Also check other runs</h2>
<p>Run 2's data - 2023-01-10 Plate 1</p>
<pre class="codeinput">data2 = <span class="string">"Z:\Processed Data\SPREADs\2023-01-10 pHBE ALI EKAR Cyto Plate 1\2023-01-10 pHBE ALI EKAR Cyto Plate 1_Processed_Copy.mat"</span>;
dataloc2 = load(data2);
dataloc2 = dataloc2.dataloc;

<span class="comment">% Extract the SPREAD data</span>
spreadData2 = convertSPREADToDataframe2(dataloc2, <span class="string">'EKAR'</span>, <span class="string">'tmaxaftertx'</span>,30,<span class="string">'aftertreatment'</span>,2,<span class="string">'exclude'</span>,{<span class="string">'gef'</span>,<span class="string">'IL6'</span>,<span class="string">'IFN'</span>});

<span class="comment">% get the statistics</span>
spreadStats2 = grpstats(spreadData2,<span class="string">"txinfo"</span>,[<span class="string">"mean"</span>,<span class="string">"median"</span>,<span class="string">"sem"</span>],<span class="string">"DataVars"</span>,<span class="string">"freq"</span>);

<span class="comment">% subtract each run's own mean from its own run</span>
spreadData2.freqSubV = spreadData2.freq - spreadStats2{<span class="string">"1 vehicle 1 vehicle"</span>,<span class="string">"mean_freq"</span>};

<span class="comment">% Add the TEER data (Mean data from the same experimental dataset, 2023-01-10)</span>
<span class="comment">% This data can be found in the Notes section of the _platemap data for the experiment</span>
teerData2 = table();
teerData2.PercChangeInTeer = [0; -22.91];
teerData2.TeerSEM = [NaN; NaN];
teerData2.Properties.RowNames = {<span class="string">'1 vehicle 1 vehicle'</span>,<span class="string">'20ng/mL IL1b 1 vehicle'</span>};

<span class="comment">% Merge the tables to make plotting easier</span>
spreadTEERdata2 = join(spreadStats2,teerData2,<span class="string">'Keys'</span>,<span class="string">'Row'</span>);

<span class="comment">% shorten the tx names for simplicity</span>
spreadTEERdata2.txinfo = strrep(spreadTEERdata2.txinfo,<span class="string">'20ng/mL IL1b 1 vehicle'</span>,<span class="string">'IL1b'</span>);
spreadTEERdata2.txinfo = strrep(spreadTEERdata2.txinfo,<span class="string">'1 vehicle 1 vehicle'</span>,<span class="string">'vehicle'</span>);

spreadTEERdata2.freq_minus_cont = spreadTEERdata2{:,<span class="string">"mean_freq"</span>} - spreadTEERdata2{<span class="string">"1 vehicle 1 vehicle"</span>,<span class="string">"mean_freq"</span>}

<span class="comment">% merge the data</span>
mergedSpreadTEERdata = [spreadTEERdata; spreadTEERdata2];

<span class="comment">% Fit a linear model to the merged data</span>
mdl2 = fitlm(mergedSpreadTEERdata,<span class="string">'PredictorVars'</span>,<span class="string">'freq_minus_cont'</span>,<span class="string">'ResponseVar'</span>,<span class="string">'PercChangeInTeer'</span>)
</pre>
<pre class="codeoutput">spreadTEERdata2 =
  2&times;8 table
                               txinfo      GroupCount    mean_freq    median_freq    sem_freq    PercChangeInTeer    TeerSEM    freq_minus_cont
                              _________    __________    _________    ___________    ________    ________________    _______    _______________
    1 vehicle 1 vehicle       "vehicle"        6          1.0543        1.0902       0.29705               0           NaN                0    
    20ng/mL IL1b 1 vehicle    "IL1b"           6          1.3569        1.4364       0.18427          -22.91           NaN          0.30257    
mdl2 = 
Linear regression model:
    PercChangeInTeer ~ 1 + freq_minus_cont

Estimated Coefficients:
                       Estimate      SE       tStat       pValue  
                       ________    ______    ________    _________
    (Intercept)        -0.7894     1.5363    -0.51382      0.63446
    freq_minus_cont    -71.567     8.9421     -8.0034    0.0013218

Number of observations: 6, Error degrees of freedom: 4
Root Mean Squared Error: 2.7
R-squared: 0.941,  Adjusted R-Squared: 0.927
F-statistic vs. constant model: 64.1, p-value = 0.00132
</pre>
<h2 id="5">Now plot Figure 4C-E to be appended to the image montages</h2>
<pre class="codeinput">figgy = figure;

<span class="comment">% Plot the spread frequency by treatment</span>
subplot(1,3,1)
bar(spreadTEERdata.txinfo,spreadTEERdata.mean_freq,<span class="string">'FaceColor'</span>,[0.75,0.75,0.75],<span class="string">'EdgeColor'</span>,<span class="string">'k'</span>, <span class="string">'LineWidth'</span>,1.5)
hold <span class="string">on</span>;
errorbar(spreadTEERdata.mean_freq,spreadTEERdata.sem_freq,<span class="string">"vertical"</span>,<span class="string">'.'</span>,<span class="string">'Color'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>, 1.5,<span class="string">'MarkerSize'</span>, 1)
ylabel(<span class="string">'SPREAD Frequency'</span>); <span class="comment">% add y label</span>
set(gca,<span class="string">'TickLength'</span>,[0.03, 0.03],<span class="string">'LineWidth'</span>,1);

<span class="comment">% plot the change in TEER by treatment</span>
subplot(1,3,2)
bar(spreadTEERdata.txinfo,spreadTEERdata.PercChangeInTeer,<span class="string">'FaceColor'</span>,[0.75,0.75,0.75],<span class="string">'EdgeColor'</span>,<span class="string">'k'</span>, <span class="string">'LineWidth'</span>,1.5)
hold <span class="string">on</span>;
errorbar(spreadTEERdata.PercChangeInTeer,spreadTEERdata.TeerSEM,<span class="string">"vertical"</span>,<span class="string">'.'</span>,<span class="string">'Color'</span>,<span class="string">'k'</span>,<span class="string">'LineWidth'</span>, 1.5,<span class="string">'MarkerSize'</span>, 1)
ylabel(<span class="string">'% Change in TEER'</span>); <span class="comment">% add y label</span>
set(gca,<span class="string">'TickLength'</span>,[0.03, 0.03],<span class="string">'LineWidth'</span>,1);


<span class="comment">% plot the SPREAD freq vs % change in teer w/ treatments colored</span>
subplot(1,3,3)
plot(mdl2,<span class="string">'LineWidth'</span>,1) <span class="comment">% plot the model</span>
set(gca,<span class="string">'TickLength'</span>,[0.03, 0.03],<span class="string">'LineWidth'</span>,1);
hold <span class="string">on</span>;
plt = gscatter(mergedSpreadTEERdata.freq_minus_cont,mergedSpreadTEERdata.PercChangeInTeer,mergedSpreadTEERdata.txinfo); <span class="comment">% add the data labels</span>
xlabel(<span class="string">'SPREAD Frequency (minus control)'</span>); <span class="comment">% add x labels</span>
xlim([-0.1,0.4]);  <span class="comment">% add x limit</span>
ylim([-30, 5]); <span class="comment">% add y limit</span>
ylabel(<span class="string">'% Change in TEER (minus control)'</span>); <span class="comment">% add y labels</span>
[plt(:).MarkerSize] = deal(30); <span class="comment">% make all of the dots larger</span>
text(-0.08,-26,0,[<span class="string">'R^2 = '</span>,num2str(mdl2.Rsquared.Ordinary)]);
text(-0.08,-28,0,[<span class="string">'p-value = '</span>,num2str(mdl2.anova.pValue(1))])
title(<span class="string">''</span>); <span class="comment">% remove the title</span>

<span class="comment">% standardize the figure</span>
set(gca,<span class="string">'TickLength'</span>,[0.03, 0.03],<span class="string">'LineWidth'</span>,1);
figgy.Units = <span class="string">"inches"</span>;
fontname(figgy,<span class="string">"Arial"</span>); fontsize(figgy,8,<span class="string">"points"</span>)
figgy.Position = [0.5,0.5,12,3];

saveas(gcf,<span class="string">'Z:\imageData\SPREADs\Plotting_Code\Figure_Outputs\F4_pHBE_ALI_SPREADs_vs_TEER.fig'</span>)
saveas(gcf,<span class="string">'Z:\imageData\SPREADs\Plotting_Code\Figure_Outputs\F4_pHBE_ALI_SPREADs_vs_TEER.svg'</span>)
</pre>
<img vspace="5" hspace="5" src="SPREADS_F4_pHBE_ALI_SPREADs_vs_TEER_01.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024a</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% Figure 4 - pHBE in differentiated in ALI

%% Figure 4A - pHBE in ALI response to 20ng/mL IL1b
% Images and sup video 7 are from 2022-11-03 pHBE ALI experiment plate 2 (data is used below as well)

% scale bar is 250uM
% from: 2022-11-03 pHBE ALI pt5 virus EKAREN4 Cytokines
% xy 25 (20ng/mL il1b treated at ~1.1hr from start) 6 min loop time
% Movie tps from start kept (in min):
% 42, 54, 66, 78, 90, 102

%% Figure 4B - pHBE ALI SPREADs occuring after 20ng/mL IL1b treatment
% Images and sup video 7 are from 2022-11-03 pHBE ALI experiment plate 2 (data is used below as well)

% scale bar is 250uM
% from: 2022-11-03 pHBE ALI pt5 virus EKAREN4 Cytokines
% xy 25 (20ng/mL il1b treated at ~1.1hr from start) 6 min loop time
% Movie tps from start kept (in min):
% 456, 468, 480, 948, 966, 984

%% Figure 4 C-E SPREAD vs TEER Correlation plot

% add paths
addpath('Z:\Code\Image Analysis\','Z:\Code\Cell Trace\','Z:\Code\Nick\')

% Make the plot for the experiment with live cell and TEER data
% Run 1's data 2022-11-03 data

% Load the live cell data
dataloc = load('Z:\Processed Data\SPREADs\2022-11-03 pHBE EKAREN4 ALI Cytokine P2\2022-11-03 pHBE EKAREN4 ALI Cytokine P2_Processed_Copy.mat');
dataloc = dataloc.dataloc;

% Extract the SPREADs data
spreadData = convertSPREADToDataframe2(dataloc, 'EKAR', 'tmaxaftertx',30);

% shorten the tx names for simplicity
spreadData.txinfo = strrep(spreadData.txinfo,'20ng/mL ',''); 
spreadData.txinfo = strrep(spreadData.txinfo,'10ng/mL ','');
spreadData.txinfo = strrep(spreadData.txinfo,'1 ','');

% get the statistics
spreadStats = grpstats(spreadData,"txinfo",["mean","median","sem"],"DataVars","freq");

% subtract each run's own mean from its own run
spreadData.freqSubV = spreadData.freq - spreadStats{"vehicle","mean_freq"};

% Add the TEER data (Mean data from the same experimental dataset, 2022-11-03 
% for both the imaged plate and the second plate that had the technical replicates)
% This data can be found in the Notes section of the _platemap data for the experiment
% Which can be found here: SPREADs\Plotting_Code\TEER_Data_For_plots.xlsx
teerData = table();
teerData.PercChangeInTeer = [0; -9.92; -19.59; -3.761];
teerData.TeerSEM = [3.5846; 2.8435; 1.8805; 1.5199];
teerData.Properties.RowNames = {'vehicle','IL6', 'IL1b','EGF'};

% Merge the tables to make plotting easier
spreadTEERdata = join(spreadStats,teerData,'Keys','Row');

% subtract the vehicle spread freq for combining replicates 
spreadTEERdata.freq_minus_cont = spreadTEERdata{:,"mean_freq"} - spreadTEERdata{"vehicle","mean_freq"}

%% Also check other runs
% Run 2's data - 2023-01-10 Plate 1
data2 = "Z:\Processed Data\SPREADs\2023-01-10 pHBE ALI EKAR Cyto Plate 1\2023-01-10 pHBE ALI EKAR Cyto Plate 1_Processed_Copy.mat";
dataloc2 = load(data2);
dataloc2 = dataloc2.dataloc;

% Extract the SPREAD data
spreadData2 = convertSPREADToDataframe2(dataloc2, 'EKAR', 'tmaxaftertx',30,'aftertreatment',2,'exclude',{'gef','IL6','IFN'});

% get the statistics
spreadStats2 = grpstats(spreadData2,"txinfo",["mean","median","sem"],"DataVars","freq");

% subtract each run's own mean from its own run
spreadData2.freqSubV = spreadData2.freq - spreadStats2{"1 vehicle 1 vehicle","mean_freq"};

% Add the TEER data (Mean data from the same experimental dataset, 2023-01-10)
% This data can be found in the Notes section of the _platemap data for the experiment
teerData2 = table();
teerData2.PercChangeInTeer = [0; -22.91];
teerData2.TeerSEM = [NaN; NaN];
teerData2.Properties.RowNames = {'1 vehicle 1 vehicle','20ng/mL IL1b 1 vehicle'};

% Merge the tables to make plotting easier
spreadTEERdata2 = join(spreadStats2,teerData2,'Keys','Row');

% shorten the tx names for simplicity
spreadTEERdata2.txinfo = strrep(spreadTEERdata2.txinfo,'20ng/mL IL1b 1 vehicle','IL1b');
spreadTEERdata2.txinfo = strrep(spreadTEERdata2.txinfo,'1 vehicle 1 vehicle','vehicle');

spreadTEERdata2.freq_minus_cont = spreadTEERdata2{:,"mean_freq"} - spreadTEERdata2{"1 vehicle 1 vehicle","mean_freq"}

% merge the data
mergedSpreadTEERdata = [spreadTEERdata; spreadTEERdata2];

% Fit a linear model to the merged data
mdl2 = fitlm(mergedSpreadTEERdata,'PredictorVars','freq_minus_cont','ResponseVar','PercChangeInTeer')

%% Now plot Figure 4C-E to be appended to the image montages
figgy = figure;

% Plot the spread frequency by treatment
subplot(1,3,1)
bar(spreadTEERdata.txinfo,spreadTEERdata.mean_freq,'FaceColor',[0.75,0.75,0.75],'EdgeColor','k', 'LineWidth',1.5)
hold on;
errorbar(spreadTEERdata.mean_freq,spreadTEERdata.sem_freq,"vertical",'.','Color','k','LineWidth', 1.5,'MarkerSize', 1)  
ylabel('SPREAD Frequency'); % add y label
set(gca,'TickLength',[0.03, 0.03],'LineWidth',1);

% plot the change in TEER by treatment
subplot(1,3,2)
bar(spreadTEERdata.txinfo,spreadTEERdata.PercChangeInTeer,'FaceColor',[0.75,0.75,0.75],'EdgeColor','k', 'LineWidth',1.5)
hold on;
errorbar(spreadTEERdata.PercChangeInTeer,spreadTEERdata.TeerSEM,"vertical",'.','Color','k','LineWidth', 1.5,'MarkerSize', 1)  
ylabel('% Change in TEER'); % add y label
set(gca,'TickLength',[0.03, 0.03],'LineWidth',1);


% plot the SPREAD freq vs % change in teer w/ treatments colored
subplot(1,3,3)
plot(mdl2,'LineWidth',1) % plot the model
set(gca,'TickLength',[0.03, 0.03],'LineWidth',1);
hold on;
plt = gscatter(mergedSpreadTEERdata.freq_minus_cont,mergedSpreadTEERdata.PercChangeInTeer,mergedSpreadTEERdata.txinfo); % add the data labels
xlabel('SPREAD Frequency (minus control)'); % add x labels
xlim([-0.1,0.4]);  % add x limit
ylim([-30, 5]); % add y limit
ylabel('% Change in TEER (minus control)'); % add y labels
[plt(:).MarkerSize] = deal(30); % make all of the dots larger
text(-0.08,-26,0,['R^2 = ',num2str(mdl2.Rsquared.Ordinary)]);
text(-0.08,-28,0,['p-value = ',num2str(mdl2.anova.pValue(1))])
title(''); % remove the title

% standardize the figure 
set(gca,'TickLength',[0.03, 0.03],'LineWidth',1);
figgy.Units = "inches";
fontname(figgy,"Arial"); fontsize(figgy,8,"points")
figgy.Position = [0.5,0.5,12,3];

saveas(gcf,'Z:\imageData\SPREADs\Plotting_Code\Figure_Outputs\F4_pHBE_ALI_SPREADs_vs_TEER.fig')
saveas(gcf,'Z:\imageData\SPREADs\Plotting_Code\Figure_Outputs\F4_pHBE_ALI_SPREADs_vs_TEER.svg')


##### SOURCE END #####
-->
</body>
</html>
